<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연성카드 시뮬레이터</title>
	<link href="https://cdn.jsdelivr.net/npm/@noonnu/one-mobile-pop@0.1.0/index.min.css" rel="stylesheet">
	<style>
	body {
    font-family: 'ONE-Mobile-POP', sans-serif;
    background-image: url('img/BG_Pattern.png'); /* 이미지의 경로를 지정합니다. */
    background-repeat: repeat; /* 이미지를 가로 및 세로로 반복합니다. */
	    text-shadow: 
        -2px -2px 0 #fff,  
         2px -2px 0 #fff,
        -2px  2px 0 #fff,
         2px  2px 0 #fff; 
}
	button {
    font-family: 'ONE-Mobile-POP', sans-serif;
	    text-shadow: 
        -2px -2px 0 #fff,  
         2px -2px 0 #fff,
        -2px  2px 0 #fff,
         2px  2px 0 #fff; 
	}
        table {
            width: 100%; /* 표의 너비를 부모 요소의 가로폭에 맞게 조절합니다. */
			border-collapse: separate; /* 테두리를 합칩니다. */

			table-layout: auto;
			  border-style: hidden;
        }

        th, td {
            padding: 10px;
            text-align: center;
			border: 2px solid white;
			background-color: #e9f5cf; /* 내부를 연두색으로 채웁니다. */
        }
		td {

		}
		img {
		  max-width: 100%;
		}
	</style>
</head>
<body>
<h1> 트릭컬 리바이브  연성카드 시뮬레이터</h1>

    <table>
        <thead>
            <tr>
                <th><img src="img/SummonsCard_01.png"></th>
                <th><img src="img/SummonsCard_02.png"></th>
                <th><img src="img/SummonsCard_03.png"></th>
                <th><img src="img/SummonsCard_04.png"></th>
                <th><img src="img/SummonsCard_05.png"></th>
                <th><img src="img/SummonsCard_06.png"></th>
                <th><img src="img/SummonsCard_07.png"></th>
                <th><img src="img/SummonsCard_08.png"></th>
                <th><img src="img/SummonsCard_09.png"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
			<td><span id="cardQuantity0"></span></td>
			<td><span id="cardQuantity1"></span></td>
			<td><span id="cardQuantity2"></span></td>
			<td><span id="cardQuantity3"></span></td>
			<td><span id="cardQuantity4"></span></td>
			<td><span id="cardQuantity5"></span></td>
			<td><span id="cardQuantity6"></span></td>
			<td><span id="cardQuantity7"></span></td>
			<td><span id="cardQuantity8"></span></td>
		</tr>
		 <tr>
			<td><button id="summonsCard0">기본 연성카드 합성</button></td>
			<td><button id="summonsCard1">★1 연성카드 합성</button></td>
			<td><button id="summonsCard2">★1~2 연성카드 합성</button></td>
			<td><button id="summonsCard3">★2 연성 확정 카드 합성</button></td>
			<td><button id="summonsCard4">★1~3 연성카드 합성</button></td>
			<td><button id="summonsCard5">강화된 ★1~3 연성카드 합성</button></td>
			<td><button id="summonsCard6">★2~3 연성카드 합성</button></td>
			<td><button id="summonsCard7">강화된 ★2~3 연성카드 합성</button></td>
			<td><button id="summonsCard8">엘다인사도 연성카드 합성</button></td>
            </tr>
            <!-- 나머지 행들을 필요한 만큼 추가할 수 있습니다. -->
        </tbody>

    </table>
	<p id="info"></p>
	<p id="getItemInfo"></p>
    <p id="result"></p>
	<p id="detail"></p>
    <script>
		var successCount = new Array(9); 
        let failureCount = 0;
        let totalCards = 0;
		let wantEldain = 0;
		var summonsCard = new Array(9); 
		summonsCard.fill(0);
		successCount.fill(0);
		
		function refreshCardQuantity(){
			document.getElementById("cardQuantity0").textContent = `${summonsCard[0]} 장`;
			document.getElementById("cardQuantity1").textContent = `${summonsCard[1]} 장`;
			document.getElementById("cardQuantity2").textContent = `${summonsCard[2]} 장`;
			document.getElementById("cardQuantity3").textContent = `${summonsCard[3]} 장`;
			document.getElementById("cardQuantity4").textContent = `${summonsCard[4]} 장`;
			document.getElementById("cardQuantity5").textContent = `${summonsCard[5]} 장`;
			document.getElementById("cardQuantity6").textContent = `${summonsCard[6]} 장`;
			document.getElementById("cardQuantity7").textContent = `${summonsCard[7]} 장`;
			document.getElementById("cardQuantity8").textContent = `${summonsCard[8]} 장`;
		}
		refreshCardQuantity();
		function enchant(percent, cardname, cardIdx, nextCardname) {
			
			const random = Math.random(); // 0 이상 1 미만의 랜덤 숫자 생성
			if(cardIdx==0 || summonsCard[cardIdx]>=2 ){ //기본강화카드거나 2장이상 모인경우만 작동
				totalCards += 2;
				summonsCard[cardIdx] = summonsCard[cardIdx]-2; //강화시 2장 소모
				if (random < percent) {
					successCount[cardIdx]++;
					summonsCard[cardIdx+1]++;
					
					document.getElementById("result").textContent = `${cardname} 강화 성공!`;
					document.getElementById("getItemInfo").textContent = `${nextCardname} 획득`;
				} else {
					failureCount++;
					if(cardIdx<=1){
						wantEldainAdd = 2**cardIdx;
					}else{
						wantEldainAdd = 2**(cardIdx+1);
					}
					
					wantEldain += 2**cardIdx;

					document.getElementById("result").textContent = `${cardname} 강화 실패... `;
					document.getElementById("getItemInfo").textContent = `${wantEldainAdd} 엘다인가지고싶다포인트 획득`;
				}
				document.getElementById("info").textContent = `소모한 전체 카드 수 : ${totalCards}, 엘다인가지고싶다포인트 : ${wantEldain}`;
				document.getElementById("detail").textContent = `${cardname} 성공 횟수 : ${successCount[cardIdx]}, 실패 횟수 : ${failureCount}`;
			}else{
				document.getElementById("result").textContent = `${cardname}가 부족합니다`;
				document.getElementById("info").textContent = `소모한 전체 카드 수 : ${totalCards}, 엘다인가지고싶다포인트 : ${wantEldain}`;
				document.getElementById("detail").textContent = `최소 2장 이상 모아주세요`;
			}
			refreshCardQuantity();

		}

        document.getElementById("summonsCard0").addEventListener("click", function() {
            enchant(0.5, '기본 연성카드', 0,  '★1 연성카드');
        });

		document.getElementById("summonsCard1").addEventListener("click", function() {
			enchant(0.47, '★1 연성카드', 1, '★1~2 연성카드');
        });

		document.getElementById("summonsCard2").addEventListener("click", function() {
			enchant(0.44, '★1~2 연성카드', 2, '★2 연성 확정 카드');
        });

		document.getElementById("summonsCard3").addEventListener("click", function() {
			enchant(0.41, '★2 연성 확정 카드', 3, '★1~3 연성카드');
        });

		document.getElementById("summonsCard4").addEventListener("click", function() {
			enchant(0.38, '★1~3 연성카드', 4, '강화된 ★1~3 연성카드');
        });

		document.getElementById("summonsCard5").addEventListener("click", function() {
			enchant(0.35, '강화된 ★1~3 연성카드', 5, '★2~3 연성카드');
        });

		document.getElementById("summonsCard6").addEventListener("click", function() {
			enchant(0.32, '★2~3 연성카드', 6, '강화된 ★2~3 연성카드');
        });

		document.getElementById("summonsCard7").addEventListener("click", function() {
			enchant(0.29, '강화된 ★2~3 연성카드', 7, '엘다인사도 연성카드');
        });
		document.getElementById("summonsCard8").addEventListener("click", function() {
			enchant(1, '엘다인사도 연성카드', 7, '엘다인사도');
        });
    </script>
</body>
</html>